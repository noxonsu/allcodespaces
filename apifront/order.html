<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Order Placement</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">ServiceMarket</a>
             <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                 <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="orders.html">My Orders</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1 class="mb-4">Order Placement</h1>

        <!-- Service Info - JS needed to fetch/display based on URL param serviceId -->
        <div class="card mb-4">
            <div class="card-header">
                Selected Service
            </div>
            <div class="card-body" id="serviceInfo">
                <h5 class="card-title">Service Name Placeholder</h5>
                <p class="card-text">Price: ... руб.</p>
                <p class="card-text"><small class="text-muted">Limits: Min ... / Max ...</small></p>
                <!-- Load details via JS -->
            </div>
        </div>

        <!-- Order Form - JS needed for validation and submission -->
        <form id="orderForm">
             <div class="mb-3">
                <label for="orderLink" class="form-label">Link</label>
                <input type="url" class="form-control" id="orderLink" placeholder="https://example.com/your-link" required>
                 <div class="invalid-feedback">
                    Please provide a valid link.
                </div>
            </div>
            <div class="mb-3">
                <label for="orderQuantity" class="form-label">Quantity</label>
                <input type="number" class="form-control" id="orderQuantity" placeholder="Enter quantity" required min="1" max="10000"> <!-- Set min/max dynamically via JS -->
                 <div class="invalid-feedback" id="quantityError">
                    Please enter a quantity within the allowed limits.
                </div>
            </div>

            <!-- Hidden input for service ID -->
            <input type="hidden" id="serviceId" name="serviceId" value=""> <!-- Populate value via JS -->

            <button type="submit" class="btn btn-primary">Proceed to Payment</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Add JS for:
        // - Reading serviceId from URL query parameter
        // - Fetching service details using serviceId from API
        // - Populating #serviceInfo section
        // - Setting min/max attributes and validation rules for #orderQuantity based on service limits
        // - Handling form submission:
        //   - Validate inputs
        //   - On valid submission, potentially store order details locally or pass to payment page
        //   - Redirect to payment.html (e.g., payment.html?serviceId=X&link=Y&quantity=Z)
        //   - Basic form validation feedback example:
        const form = document.getElementById('orderForm');
        form.addEventListener('submit', event => {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            // Add custom quantity validation against service limits here
            // Example: Check if quantity is within fetched min/max
            // If invalid:
            // const quantityInput = document.getElementById('orderQuantity');
            // quantityInput.classList.add('is-invalid');
            // document.getElementById('quantityError').textContent = 'Quantity must be between MIN and MAX.';
            // event.preventDefault();
            // event.stopPropagation();

            form.classList.add('was-validated'); // Bootstrap validation styles
        }, false);

        // Example: Get serviceId from URL
        const urlParams = new URLSearchParams(window.location.search);
        const serviceId = urlParams.get('serviceId');
        if (serviceId) {
            document.getElementById('serviceId').value = serviceId;
            // Fetch service details using this ID...
            console.log("Selected Service ID:", serviceId);
        } else {
            // Handle error: No service ID provided
            console.error("No Service ID found in URL");
            // Maybe redirect back or show an error message
        }

    </script>
</body>
</html>
